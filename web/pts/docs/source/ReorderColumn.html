<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='PTS-view-controls-ReorderColumn'>/**
</span> * Column Action that allows row order to be changed and persisted.
 */
Ext.define('PTS.view.controls.ReorderColumn', {
    extend: 'Ext.grid.column.Action',
    alias: 'widget.reordercolumn',
    //requires: ['PTS.store.Positions'],

    header: 'Priority',
    tooltip: 'The priority is set by order of appearance.',

	constructor : function(config) {
		var me = this,
		    cfg = Ext.apply({}, config);

            Ext.apply(cfg, {
                width: 50,
                items: [{
                    getClass: function(v, meta, rec, rowIndex) { //Return a class from a function
                        if (rowIndex &gt; 0) {
                            this.items[0].tooltip = 'Move up';
                            return 'pts-arrow-up';
                        } else {
                            return 'pts-arrow-up-disabled';
                        }
                    },
                    handler: function(grid, rowIndex, colIndex) {
                        if (rowIndex &gt; 0) {
                            var store = grid.getStore(),
                            row,rowEl,
                            rec = store.getAt(rowIndex);
                            store.removeAt(rowIndex);
                            //to prevent sending a delete request on sync
                            //we have to remove the record from the stores removed[]
                            if(!rec.phantom) {Ext.Array.remove(store.removed, rec);}
                            store.insert(rowIndex - 1,rec);
                            row = grid.getNode(rowIndex - 1);
                            rowEl = Ext.get(row);
                            rowEl.addCls('pts-grid-row-hilite');
                            rowEl.highlight( 'ffff9c' , {
                                attr: &quot;backgroundColor&quot;,
                                easing: 'easeIn',
                                duration: 1500,
                                callback: function(){
                                    rowEl.removeCls('pts-grid-row-hilite');
                                },
                                scope: rowEl
                            });
                        }
                    }
                }, {
                    getClass: function(v, meta, rec, rowIndex, colIndex, store) {
                        if (rowIndex + 1 !== store.getCount()) {
                            this.items[1].tooltip = 'Move down';
                            return 'pts-arrow-down';
                        } else {
                            return 'pts-arrow-down-disabled';
                        }
                    },
                    handler: function(grid, rowIndex, colIndex) {
                        if (rowIndex - 1 &lt; grid.getStore().getCount()) {
                            var store = grid.getStore(),
                            row,rowEl,
                            rec = store.getAt(rowIndex);
                            store.removeAt(rowIndex);
                            //to prevent sending a delete request on sync
                            //we have to remove the record from the stores removed[]
                            if(!rec.phantom) {Ext.Array.remove(store.removed, rec);}
                            store.insert(rowIndex + 1,rec);
                            row = grid.getNode(rowIndex + 1);
                            rowEl = Ext.get(row);
                            rowEl.addCls('pts-grid-row-hilite');
                            rowEl.highlight( 'ffff9c' , {
                                attr: &quot;backgroundColor&quot;,
                                easing: 'easeIn',
                                duration: 1500,
                                callback: function(){
                                    rowEl.removeCls('pts-grid-row-hilite');
                                },
                                scope: rowEl
                            });
                        }
                    }
                }]
            });
		me.callParent([cfg]);
	}
});
</pre>
</body>
</html>
