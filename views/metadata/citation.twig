{% macro citation(c) %}
  {% import "metadata/contactref.twig" as contactref %}
  {% set project, resource, organization = c.resourceType == 'project', c.resource, c.organization %}
	{% autoescape 'json' %}
	  {
        "title": "{{ resource.title }}",
        "date": [
          {% if project %}
          {
            "date": "{{ resource.datecreated|default(resource.startdate) }}",
            "dateType": "creation"
          }
          {% else %}
            {% for date in c.dates %}
                {% if not loop.first %},{% endif %}
                {
                  "date": "{{ date.date }}",
                  "dateType": "{{ date.dateType }}"
                }
            {% endfor %}
          {% endif %}
        ],
        {# "edition": "", #}
        "responsibleParty": [
          {
            "contactId": "{{ organization.contactId }}",
            "role": "owner"
          }
          {% if project %}
          {{ contactref.ref(c.roles,[7,10,1,4,9],true) }}
          {% else %}
          {{ contactref.ref(c.roles,false,true) }}
          {% endif %}
        ],
        {# "presentationForm": [""], #}
        "identifier": [
          {
            "identifier": "{{ resource.resourceIdentifier }}",
            "type": "uuid",
            "authority": {
              "title": "{{ organization.organizationName }}",
              {% if project %}
              "date": [{
                "date": "{{ resource.datecreated|default(resource.startdate) }}",
                "dateType": "creation"
              }],
              {% endif %}
              "responsibleParty": [
                {
                  "contactId": "{{ organization.contactId }}",
                  "role": "originator"
                }
              ]
            }
          }{% if project %},
          {
            "identifier": "{{ resource.projectcode }}",
            "type": "projectCode",
            "authority": {
              "title": "{{ organization.organizationName }}",
              "date": [{
                "date": "{{ resource.datecreated|default(resource.startdate) }}",
                "dateType": "creation"
              }],
              "responsibleParty": [
                {
                  "contactId": "{{ organization.contactId }}",
                  "role": "originator"
                }
              ]
            }
          }{% endif %}{% if resource.sciencebaseid %},
          {
            "identifier": "{{ resource.sciencebaseid }}",
            "type": "scienceBase",
            "authority": {
              "title": "{{ 'ScienceBase identifier for the resource' }}",
              "date": [{
                "date": "{{ resource.datecreated|default(resource.startdate) }}",
                "dateType": "creation"
              }]
            }
          }{% endif %}
        ],
        "onlineResource": [
          {
            "uri": "{{ resource.uri }}",
            "protocol": "http",
            "name": "Resource website",
            "description": "Web page with detailed information about the resource.",
            "function": "information"
          }
        ]
      }
	{% endautoescape %}
{% endmacro %}
