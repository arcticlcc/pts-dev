{% import "metadata/citation.twig" as citation %}
{% autoescape 'json' %}
    {
      "metadataIdentifier": {
        "identifier": "{{ resource.resourceIdentifier }}",
        "type": "uuid"
      },
      {% if parentmetadata is defined and not parentmetadata is empty %}
      "parentMetadata": {{ citation.citation(parentmetadata) }},
      {% elseif parentsciencebaseid is defined and not parentsciencebaseid is empty %}
      "parentMetadata": {
        "title": "Parent metadata for resource",
        "date": [
          {
            "date": "{{ resource.datecreated|default(resource.startdate) }}",,
            "dateType": "unknown"
          }
        ],
        "identifier": [
          {% if parentsciencebaseid %}
          {
            "identifier": {{ parentsciencebaseid }},
            "type": "scienceBase"
          }
          {% endif %}
        ]
      },
      {% endif %}
      "metadataContact": [
          {
            "contactId": "{{ organization.contactId }}",
            "role": "author"
          }
          {% if resourceType == 'project' %}
          {{ contactref.ref(roles,[8,3],true) }}
          {% endif %}
      ],
      "metadataCreationDate": "{{ (resource.metadataupdate|default("now"))|date('c') }}",
      "metadataLastUpdate": "{{ "now"|date('c') }}",
      "metadataCharacterSet": "utf8",
      "metadataUri": "http://metadata.arcticlcc.org/{{ resource.resourceIdentifier }}",
      "metadataStatus": "completed",
      "metadataMaintenance": {
        "maintenanceFrequency": "asNeeded",
        "maintenanceNote": ["Metadata records are generated from database"],
        "maintenanceContact": [
          {
            "contactId": "{{ organization.contactId }}",
            "role": "author"
          }
          {% if resourceType == 'project' %}
          {{ contactref.ref(roles,[8],true) }}
          {% endif %}
        ]
      }
    }
{% endautoescape %}
